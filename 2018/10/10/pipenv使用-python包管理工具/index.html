<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Author chefZhang"><title>pipenv使用-python包管理工具 · 乱里库码</title><meta name="description" content="pipenv简介pipenv是python官方推荐的包管理工具，方便管理python的虚拟环境和库，集成了virtualenv，pyenv和pip三者的功能于一身。能够自动为项目创建和管理虚拟环境，从Pipfile文件中添加或者删除包，同事生成Pipfile.lock文件锁定安装包的版本和依赖信息，"><meta name="keywords" content="iOS,Hexo,HTML,CSS"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">乱里库码</a></h3><div class="description"><p>生活杂记</p></div></div></div><ul class="social-links"><li><a href="http://github.com/ChefZhang"><i class="fa fa-github"></i></a></li></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a href="https://www.caicai.me"> CaiCai </a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li><li><a href="/about">关于</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="http://upload-images.jianshu.io/upload_images/328309-f0893d1d69f1787d.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>pipenv使用-python包管理工具</a></h3></div><div class="post-content"><h2 id="pipenv简介"><a href="#pipenv简介" class="headerlink" title="pipenv简介"></a>pipenv简介</h2><p>pipenv是python官方推荐的包管理工具，方便管理python的虚拟环境和库，集成了virtualenv，pyenv和pip三者的功能于一身。能够自动为项目创建和管理虚拟环境，从<code>Pipfile</code>文件中添加或者删除包，同事生成<code>Pipfile.lock</code>文件锁定安装包的版本和依赖信息，避免构建错误。</p>
<p>为什么要用pipenv呢？或者说原来的三个工具不是也直接用么？</p>
<p>直接用virtualenv可能会导致的问题：</p>
<ul>
<li>必须手动安装或删除某些特定版本的包，并定期更新requirements.txt文件，以保持项目环境一致</li>
<li>有时项目需要有多个requirements.txt文件，比如开发用dev-requirements.txt，现有的模式不满足</li>
<li>卸载包的时候只是卸载自己，不能处理相关依赖项</li>
</ul>
<p>pipenv主要解决的问题：</p>
<ul>
<li>不需要单独使用virtualenv，pyenv和pip，把他们结合在一起。</li>
<li>不用维护requirements.txt文件</li>
<li>在开发环境中使用多个python版本</li>
<li>在安装pyenv的条件下，可以自动安装需要的python版本</li>
<li>随时查看图形化的依赖关系</li>
<li>其他</li>
</ul>
<h2 id="安装pipenv"><a href="#安装pipenv" class="headerlink" title="安装pipenv"></a>安装pipenv</h2><p>以下是Mac的环境</p>
<h3 id="使用pip安装"><a href="#使用pip安装" class="headerlink" title="使用pip安装"></a>使用pip安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ pip install --user pipenv</div></pre></td></tr></table></figure>
<p>这个命令在用户级别下安装pipenv。如果安装后在shell中找不到pipenv命令，需要添加当前python用户主目录的bin目录到PATH环境变量。如果不知道python用户主目录在哪里，输入以下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ python -m site --user-base</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/Users/xxx/Library/Python/2.7</div></pre></td></tr></table></figure>
<h3 id="使用brew安装"><a href="#使用brew安装" class="headerlink" title="使用brew安装"></a>使用brew安装</h3><p>直接使用brew安装即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ brew install pipenv</div></pre></td></tr></table></figure>
<p>接下来会提示升级pipenv：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ brew upgrade pipenv</div></pre></td></tr></table></figure>
<h3 id="shell自动补齐"><a href="#shell自动补齐" class="headerlink" title="shell自动补齐"></a>shell自动补齐</h3><p>在Linux或者Mac环境下，在<code>.bashrc</code>或<code>.zshrc</code>添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">eval &quot;$(pipenv --completion)&quot;</div></pre></td></tr></table></figure>
<h2 id="使用pipenv"><a href="#使用pipenv" class="headerlink" title="使用pipenv"></a>使用pipenv</h2><h3 id="创建环境"><a href="#创建环境" class="headerlink" title="创建环境"></a>创建环境</h3><p>新建一个目录，安装指定python的版本信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ mkdir test_pipenv &amp; cd test_pipenv</div><div class="line">$ pipenv install  	// pipenv install --three</div></pre></td></tr></table></figure>
<p>如果指定了 <code>--two</code>或<code>--three</code>，则会使用python2或者python3的版本安装，否则将使用默认的python版本来安装。</p>
<p>也可以指定版本信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ pipenv install --python 3</div><div class="line">$ pipenv install --python 3.6</div><div class="line">$ pipenv install --python 2.7.14</div></pre></td></tr></table></figure>
<h3 id="安装第三方库"><a href="#安装第三方库" class="headerlink" title="安装第三方库"></a>安装第三方库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pipenv install urllib3</div></pre></td></tr></table></figure>
<p>也可以安装指定包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pipenv install urllib3==1.22</div></pre></td></tr></table></figure>
<p>Pipfile中的<code>source</code>是设置仓库地址，<code>packages</code>是指定项目依赖的包，<code>dev-packages</code>是指定开发环境需要的包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">[[source]]</div><div class="line">url = &quot;https://pypi.org/simple&quot;</div><div class="line">verify_ssl = true</div><div class="line">name = &quot;pypi&quot;</div><div class="line"></div><div class="line">[packages]</div><div class="line">&quot;urllib3&quot; = &quot;*&quot;</div><div class="line"></div><div class="line">[dev-packages]</div><div class="line"></div><div class="line">[requires]</div><div class="line">python_version = &quot;3.6&quot;</div></pre></td></tr></table></figure>
<p>Pipfile.lock包含你的系统信息，所有已经安装包的依赖包以及其版本信息，所有安装包及依赖包的hash校验信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    &quot;_meta&quot;: &#123;</div><div class="line">        &quot;hash&quot;: &#123;</div><div class="line">            &quot;sha256&quot;: &quot;af58f3510cb613d4d9241128f9a0ceb9bb936ad907543e23ad8317011dcb6715&quot;</div><div class="line">        &#125;,</div><div class="line">        &quot;pipfile-spec&quot;: 6,</div><div class="line">        &quot;requires&quot;: &#123;</div><div class="line">            &quot;python_version&quot;: &quot;3.6&quot;</div><div class="line">        &#125;,</div><div class="line">        &quot;sources&quot;: [</div><div class="line">            &#123;</div><div class="line">                &quot;name&quot;: &quot;pypi&quot;,</div><div class="line">                &quot;url&quot;: &quot;https://pypi.org/simple&quot;,</div><div class="line">                &quot;verify_ssl&quot;: true</div><div class="line">            &#125;</div><div class="line">        ]</div><div class="line">    &#125;,</div><div class="line">    &quot;default&quot;: &#123;                </div><div class="line">         &quot;urllib3&quot;: &#123;</div><div class="line">            &quot;hashes&quot;: [</div><div class="line">                &quot;sha256:a68ac5e15e76e7e5dd2b8f94007233e01effe3e50e8daddf69acfd81cb686baf&quot;,</div><div class="line">                &quot;sha256:b5725a0bd4ba422ab0e66e89e030c806576753ea3ee08554382c14e685d117b5&quot;</div><div class="line">            ],</div><div class="line">            &quot;index&quot;: &quot;pypi&quot;,</div><div class="line">            &quot;version&quot;: &quot;==1.23&quot;</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    &quot;develop&quot;: &#123;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="安装开发环境下的包"><a href="#安装开发环境下的包" class="headerlink" title="安装开发环境下的包"></a>安装开发环境下的包</h4><p>加<code>--dev</code>表示包括 Pipfile 的 dev-packages 中的依赖。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pipenv install httpie --dev</div></pre></td></tr></table></figure>
<h3 id="卸载第三方包"><a href="#卸载第三方包" class="headerlink" title="卸载第三方包"></a>卸载第三方包</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pipenv uninstall urllib3 //或者 pipenv uninstall --all</div></pre></td></tr></table></figure>
<h3 id="更新安装包"><a href="#更新安装包" class="headerlink" title="更新安装包"></a>更新安装包</h3><p>更新指定包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pipenv update urllib3</div></pre></td></tr></table></figure>
<p>更新所有包（删除所有包，然后重新安装）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pipenv update</div></pre></td></tr></table></figure>
<h3 id="进入-退出环境"><a href="#进入-退出环境" class="headerlink" title="进入|退出环境"></a>进入|退出环境</h3><p>进入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pipenv shell</div></pre></td></tr></table></figure>
<p>在进入之后，可以直接输入python来查看当前python环境</p>
<p>退出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">exit</div></pre></td></tr></table></figure>
<h3 id="查看虚拟环境目录"><a href="#查看虚拟环境目录" class="headerlink" title="查看虚拟环境目录"></a>查看虚拟环境目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ pipenv --venv</div><div class="line">/Users/xxx/.local/share/virtualenvs/test_pipenv-UtK8HKY2</div></pre></td></tr></table></figure>
<h3 id="检查软件包的完整性"><a href="#检查软件包的完整性" class="headerlink" title="检查软件包的完整性"></a>检查软件包的完整性</h3><p>你是否担心已安装的软件包有没有安全漏洞？没关系，pipenv 可以帮你检查，运行下面的命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$  pipenv check</div><div class="line">Checking PEP 508 requirements…</div><div class="line">Passed!</div><div class="line">Checking installed package safety…</div><div class="line">All good!</div></pre></td></tr></table></figure>
<p>上面的命令根据 Pipfile 里的 PEP 508 标记检查安全漏洞。</p>
<h3 id="查看依赖树"><a href="#查看依赖树" class="headerlink" title="查看依赖树"></a>查看依赖树</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$ pipenv graph</div><div class="line">httpie==0.9.9</div><div class="line">  - Pygments [required: &gt;=2.1.3, installed: 2.2.0]</div><div class="line">  - requests [required: &gt;=2.11.0, installed: 2.19.1]</div><div class="line">    - certifi [required: &gt;=2017.4.17, installed: 2018.4.16]</div><div class="line">    - chardet [required: &lt;3.1.0,&gt;=3.0.2, installed: 3.0.4]</div><div class="line">    - idna [required: &lt;2.8,&gt;=2.5, installed: 2.7]</div><div class="line">    - urllib3 [required: &gt;=1.21.1,&lt;1.24, installed: 1.23]</div></pre></td></tr></table></figure>
<h3 id="锁定版本"><a href="#锁定版本" class="headerlink" title="锁定版本"></a>锁定版本</h3><p>更新 lock 文件锁定当前环境的依赖版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pipenv lock</div></pre></td></tr></table></figure>
<h3 id="环境变量管理"><a href="#环境变量管理" class="headerlink" title="环境变量管理"></a>环境变量管理</h3><p>如果你开发调试时需要配一堆环境变量，可以写到 .env 文件中，在 pipenv shell 进入虚拟环境时，它会帮你把这些环境变量加载好，非常方便。</p>
<p>例如写一个 .env 文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">echo &quot;FOO=hello foo&quot; &gt; .env</div></pre></td></tr></table></figure>
<p>之后 pipenv shell 进入虚拟环境，echo $FOO 就能看环境变量的值 hello foo 已经设置好了。</p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2018-10-10</span><i class="fa fa-tag"></i><a class="tag" href="/categories/python/" title="python">python </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" href="http://twitter.com/home?status=,http://yoursite.com/2018/10/10/pipenv使用-python包管理工具/,乱里库码,pipenv使用-python包管理工具,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="next pagbuttons"><a class="btn" role="navigation" href="/2018/09/20/UITableView偏移/" title="UITableView偏移">下一篇</a></li></ul></div><a id="comments"></a><div id="vcomments" style="margin:0 30px;"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/gh/xcss/valine@v1.1.7/dist/Valine.min.js?v=undefined"></script><script>var valine = new Valine({
  el:'#vcomments',
  notify:false || false, 
  verify:false|| false, 
  app_id:'cCvO1WkU4CxdrgVlL1xVKUGy-gzGzoHsz',
  app_key:'LVDXkJkVmzeGKLMytUjKz6Fm',
  placeholder:'Just go go',
  path: window.location.pathname,
  avatar:'mm'
})</script></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>